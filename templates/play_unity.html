<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cronos - {{ title }} Jogar</title>
  <link rel="icon" href="{{url_for('static', filename='img/cronos_logo_neon_transparent-removebg-preview.png')}}">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        crossorigin="anonymous">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/user_player.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/particula.css') }}" />
</head>

<body>
  <div class="particles" id="particles"></div>

  <header class="header">
    <div class="logo-container">
      <img src="{{ url_for('static', filename='img/cronos_logo_neon_transparent-removebg-preview.png') }}"
           alt="logo" width="50">
      <h1>Cronos</h1>
    </div>

    <!-- Ícone burger (mobile) -->
    <img
      src="{{ url_for('static', filename='img/1000_F_225221877_9x7repcZzz4ryhvZ4Z5DmlnnCTdTUImT-removebg-preview.png') }}"
      alt="Menu" class="menu-burger-icon" id="burgerBtn">

    <nav class="nav" id="mainNav" aria-label="Navegação principal">
      <a href="{{ url_for('index') }}"><button class="nav-button">Home</button></a>
      <a href="{{ url_for('biblioteca') }}"><button class="nav-button active">Biblioteca</button></a>
      <a href="{{ url_for('loja') }}"><button class="nav-button">Loja</button></a>
      <a href="{{ url_for('suporte') }}"><button class="nav-button">Suporte</button></a>
      {% if session.get('user_role') == 'dev' or session.get('user_role') == 'admin' %}
      <a href="{{ url_for('dev_upload') }}"><button class="nav-button">Dev</button></a>
      {% endif %}
      {% if session.get('user_role') == 'admin' %}
      <a href="{{ url_for('admin_index') }}"><button class="nav-button">Admin</button></a>
      {% endif %}
    </nav>

    <div class="perfil" role="button" aria-haspopup="true" aria-expanded="false" id="perfilBtn">
      <div class="avatar" aria-hidden="true">
        {% if session.get('user_avatar') %}
        <img src="/{{ session.get('user_avatar') }}" alt="Avatar">
        {% else %}
        <img src="{{ url_for('static', filename='img/default-avatar.png') }}" alt="Avatar">
        {% endif %}
      </div>
      <span>
        {% if session.get('user_id') %}
        {{ session.get('user_nick') or session.get('user_name') }}
        {% else %} PERFIL {% endif %}
      </span>
    </div>

    <div class="profile-menu" id="profileMenu">
      <div class="profile-header">
        <div class="profile-avatar">
          {% if session.get('user_avatar') %}
          <img src="/{{ session.get('user_avatar') }}" alt="Avatar do usuário">
          {% else %}
          <img src="{{ url_for('static', filename='img/default-avatar.png') }}" alt="Avatar padrão">
          {% endif %}
        </div>
        <div class="profile-info">
          <h4>
            {% if session.get('user_id') %}
            {{ session.get('user_nick') or session.get('user_name') }}
            {% else %}
            Usuário Cronos
            {% endif %}
          </h4>
          <p>
            {% if session.get('user_id') %}
            Nível {{ session.get('user_level', 1) }}
            {% else %}
            Nível 1
            {% endif %}
          </p>
        </div>
      </div>
      <div class="profile-actions">
        {% if session.get('user_id') %}
        <a class="profile-action-btn" href="{{ url_for('perfilConfig') }}">Meu Perfil</a>
        <a class="profile-action-btn" href="{{ url_for('perfilConfig') }}">Configurações</a>
        <a class="profile-action-btn"
           href="{{ url_for('logout', next=request.full_path or request.path) }}">Sair</a>
        <a href="{{ url_for('politicas') }}" class="profile-action-btn">Políticas</a>
        {% else %}
        <a class="profile-action-btn" href="{{ url_for('login') }}">Entrar</a>
        <a class="profile-action-btn" href="{{ url_for('cadastrar') }}">Cadastrar</a>
        <a class="profile-action-btn" href="{{ url_for('perfilConfig') }}">Configurações</a>
        <a href="{{ url_for('politicas') }}" class="profile-action-btn">Políticas</a>
        {% endif %}
      </div>
    </div>
  </header>

  <div id="hotTop" aria-hidden="true"></div>

  <main class="container game-container">
    <h2 class="title">{{ title }}</h2>
    <div id="frameWrap" class="game-frame shadow">
      <div id="playCatcher" class="play-catcher" aria-hidden="true"></div>
      <iframe id="gameFrame" src="{{ direct_url }}" title="{{ title }}"
              allow="autoplay; fullscreen; gamepad; xr-spatial-tracking"
              loading="lazy" referrerpolicy="no-referrer"></iframe>
      <div id="loader" class="loader" aria-live="polite">
        <div class="spinner-border" role="status" aria-label="Carregando"></div>
        <div class="muted">Carregando jogo…</div>
      </div>
    </div>
  </main>

  <script src="{{ url_for('static', filename='js/particula.js') }}"></script>
  <script src="{{ url_for('static', filename='JS/unity_player.js') }}"></script>
</body>

</html>
